{"version":3,"file":"taquito-tezbridge-signer.es5.js","sources":["../src/version.ts","../src/taquito-tezbridge-signer.ts"],"sourcesContent":["\n// IMPORTANT: THIS FILE IS AUTO GENERATED! DO NOT MANUALLY EDIT OR CHECKIN!\n/* tslint:disable */\nexport const VERSION = {\n    \"commitHash\": \"33283ebb64d801dcbb0926ad199d024ad7189861\",\n    \"version\": \"10.1.0\"\n};\n/* tslint:enable */\n","/**\n * @packageDocumentation\n * @module @taquito/tezbridge-signer\n */\nimport { b58cdecode, b58cencode, buf2hex, prefix, isValidPrefix } from '@taquito/utils';\nimport toBuffer from 'typedarray-to-buffer';\n\ndeclare var tezbridge: any;\n\nexport { VERSION } from './version';\nexport class TezBridgeSigner {\n  constructor() {\n    if (typeof tezbridge === 'undefined') {\n      throw new Error('tezbridge plugin could not be detected in your browser');\n    }\n  }\n\n  async publicKeyHash(): Promise<string> {\n    return tezbridge.request({ method: 'get_source' });\n  }\n\n  async publicKey(): Promise<string> {\n    throw new Error('Public key cannot be exposed');\n  }\n\n  async secretKey(): Promise<string> {\n    throw new Error('Secret key cannot be exposed');\n  }\n\n  async sign(bytes: string, _watermark?: Uint8Array) {\n    const prefixSig = await tezbridge.request({\n      method: 'raw_sign',\n      bytes, // Any operation bytes as string\n    });\n\n    const pref = prefixSig.substr(0, 5);\n\n    if (!isValidPrefix(pref)) {\n      throw new Error('Unsupported signature given by tezbridge: ' + prefixSig);\n    }\n\n    const decoded = b58cdecode(prefixSig, prefix[pref]);\n\n    return {\n      bytes,\n      sig: b58cencode(decoded, prefix.sig),\n      prefixSig,\n      sbytes: bytes + buf2hex(toBuffer(decoded)),\n    };\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;AACA;IACa,OAAO,GAAG;IACnB,YAAY,EAAE,0CAA0C;IACxD,SAAS,EAAE,QAAQ;EACrB;AACF;;;ICIE;QACE,IAAI,OAAO,SAAS,KAAK,WAAW,EAAE;YACpC,MAAM,IAAI,KAAK,CAAC,wDAAwD,CAAC,CAAC;SAC3E;KACF;IAEK,uCAAa,GAAnB;;;gBACE,sBAAO,SAAS,CAAC,OAAO,CAAC,EAAE,MAAM,EAAE,YAAY,EAAE,CAAC,EAAC;;;KACpD;IAEK,mCAAS,GAAf;;;gBACE,MAAM,IAAI,KAAK,CAAC,8BAA8B,CAAC,CAAC;;;KACjD;IAEK,mCAAS,GAAf;;;gBACE,MAAM,IAAI,KAAK,CAAC,8BAA8B,CAAC,CAAC;;;KACjD;IAEK,8BAAI,GAAV,UAAW,KAAa,EAAE,UAAuB;;;;;4BAC7B,qBAAM,SAAS,CAAC,OAAO,CAAC;4BACxC,MAAM,EAAE,UAAU;4BAClB,KAAK,OAAA;yBACN,CAAC,EAAA;;wBAHI,SAAS,GAAG,SAGhB;wBAEI,IAAI,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;wBAEpC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,EAAE;4BACxB,MAAM,IAAI,KAAK,CAAC,4CAA4C,GAAG,SAAS,CAAC,CAAC;yBAC3E;wBAEK,OAAO,GAAG,UAAU,CAAC,SAAS,EAAE,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC;wBAEpD,sBAAO;gCACL,KAAK,OAAA;gCACL,GAAG,EAAE,UAAU,CAAC,OAAO,EAAE,MAAM,CAAC,GAAG,CAAC;gCACpC,SAAS,WAAA;gCACT,MAAM,EAAE,KAAK,GAAG,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;6BAC3C,EAAC;;;;KACH;IACH,sBAAC;AAAD,CAAC;;;;"}